registrationModule.controller("searchController",function(e,n,a,o,r){n.searchlevel=1;var t=function(e,n,a,r){$("#btnEnviar").button("reset"),$("#btnBuscar").button("reset"),o.error("Ocurrio un problema")};e.init=function(){e.loadDivision(),e.loadTipos()},e.Search=function(){if(null==n.empresa&&null==n.agencia&&null==n.departamento&&null==e.folioBusca)o.warning("Debe proporcionar al menos alguno de los filtros de busqueda.");else{var a=null==n.empresa?0:n.empresa.idEmpresa,i=null==n.agencia?0:n.agencia.idSucursal,l=null==n.departamento?0:n.departamento.idDepartamento,s=null==e.folioBusca?"":e.folioBusca;$("#btnBuscar").button("loading"),r.getFolios(s,a,i,l).success(p).error(t)}},e.Salir=function(){var e=window.self;e.opener=window.self,e.close()},e.CloseGrid=function(){$("#finder").animate({width:"hide"})},e.HideView=function(){},e.loadTipos=function(){r.getTipos().success(i).error(t)};var i=function(e,a,o,r){n.listaTipos=e};e.SetTipo=function(e){n.tipo=e},e.ClearTipo=function(){n.tipo=null};var l=function(e,a,o,r){n.listaDivisiones=e};e.loadDivision=function(){r.getDivision().success(l).error(t)},e.SetDivision=function(a){e.ClearDivision(),n.division=a,n.searchlevel=2,e.LoadEmpresa()},e.ClearDivision=function(){n.division=null,n.searchlevel=1,n.empresa=null,n.agencia=null,n.departamento=null};var s=function(e,a,o,r){n.listaEmpresas=e};e.LoadEmpresa=function(){r.getEmpresa(n.empleado.idUsuario).success(s).error(t)},e.SetEmpresa=function(a){e.ClearEmpresa(),n.empresa=a,n.searchlevel=3,e.LoadAgencia()},e.ClearEmpresa=function(){n.empresa=null,n.searchlevel=2,n.agencia=null,n.departamento=null};var c=function(e,a,o,r){n.listaAgencias=e};e.LoadAgencia=function(){r.getSucursal(n.empleado.idUsuario,n.empresa.idEmpresa).success(c).error(t)},e.SetAgencia=function(a){e.ClearAgencia(),n.agencia=a,n.searchlevel=4,e.LoadDepartamento()},e.ClearAgencia=function(){n.agencia=null,n.searchlevel=3,n.departamento=null};var u=function(e,a,o,r){n.listaDepartamentos=e};e.LoadDepartamento=function(){r.getDepartamento(n.empleado.idUsuario,n.empresa.idEmpresa,n.agencia.idSucursal).success(u).error(t)},e.SetDepartamento=function(e){n.departamento=e,n.searchlevel=5},e.ClearDepartamento=function(){n.departamento=null},e.ShowSearchProveedor=function(){$("#searchProveedor").modal("show")},e.BuscarProveedor=function(){r.getProveedor(e.textProveedor).success(d).error(t)};var d=function(e,a,r,t){n.listaProveedores=e,o.success("Se ha(n) encontrado "+e.length+" proveedor(es) que coniciden con la b√∫squeda.")};e.SetProveedor=function(e){n.proveedor=e,$("#searchProveedor").modal("hide")},e.ClearProveedor=function(){n.proveedor=null},e.today=function(){e.dt1=new Date,e.dt2=new Date},e.today(),e.clear=function(){e.dt1=null,e.dt2=null},e.disabled=function(e,n){return"day"===n&&(-1===e.getDay()||7===e.getDay())},e.toggleMin=function(){e.minDate=e.minDate?null:new Date},e.toggleMin(),e.open1=function(n){n.preventDefault(),n.stopPropagation(),e.opened1=!0},e.open2=function(n){n.preventDefault(),n.stopPropagation(),e.opened2=!0},e.dateOptions={formatYear:"yy",startingDay:1},e.initDate=new Date,e.formats=["dd-MMMM-yyyy","yyyy/MM/dd","dd.MM.yyyy","shortDate"],n.format=e.formats[0];var p=function(e,a,o,r){n.ordenesCompra=e,$("#btnBuscar").button("reset"),$("#searchResultsO").modal("show")};e.CargaOrden=function(e){$("#closeMenu").click(),$("#searchResultsO").modal("hide"),n.CargaEmpleado(e.Folio_Operacion)}});